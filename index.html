<html>
  <head>
    <title>Sprint+</title>
    <link rel="icon" href="Images & Icons/Logo.ico">
    <link href="https://fonts.cdnfonts.com/css/garet" rel="stylesheet">
    <meta name="viewport" content="width=device-width" />

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Comfortaa:wght@500&family=Encode+Sans+SC:wght@600&family=Fira+Sans:wght@500&family=Heebo&family=Josefin+Sans:wght@600&family=Kanit:wght@300&family=Lato:wght@700&family=Poppins&family=Roboto:wght@300;400&family=Rubik+Distressed&family=Source+Sans+Pro&family=Ubuntu&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="CSS Files/Projects.css">
    <link rel="stylesheet" href="CSS Files/Main.css">
    <link rel="stylesheet" href="CSS Files/progress.css">
    <link rel="stylesheet" href="CSS Files/review_form.css">
    <link rel="stylesheet" href="CSS Files/new_goal.css">
    <link rel="stylesheet" href="goal_management.css">
    <link rel="stylesheet" href="CSS Files/download.css">
    <link rel="stylesheet" href="welcome.css">
    <link rel="stylesheet" href="CSS Files/informations.css">
    <link rel="stylesheet" href="CSS Files/inspiration.css">
    <link rel="stylesheet" href="CSS Files/todo.css">
    <link rel="stylesheet" href="CSS Files/notifications.css">
    <link rel="stylesheet" href="CSS Files/writing.css">

    <script type="text/javascript" src="Scripts/Download.js"></script>
    <script type="text/javascript" src="Scripts/projects.js"></script>
    <script type="text/javascript" src="Scripts/save_content.js"></script>
    <script type="text/javascript" src="Scripts/security.js"></script>
    <script type="text/javascript" src="goal_management.js"></script>
    <script type="text/javascript" src="Scripts/menu.js"></script>
    <script type="text/javascript" src="Scripts/informations.js"></script>
    <script type="text/javascript" src="Scripts/inspiration.js"></script>
    <script type="text/javascript" src="Scripts/todo.js"></script>
    <script type="text/javascript" src="Scripts/onclick.js"></script>
    <script type="text/javascript" src="Scripts/notifications.js"></script>
    <script type="text/javascript" src="Scripts/writing.js"></script>
    <script type="text/javascript" src="Scripts/createPassword.js"></script>


    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,400,0,0" />
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Encode+Sans+SC:wght@600&family=Fira+Sans:wght@500&family=Kanit:wght@300&family=Poppins&family=Roboto:wght@300;400&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20,700,0,0" />
  </head>
  <body>
    <div id="ad">

    </div>
    <img src="Images & Icons/Sprint+ logo blank.png" id="SprintPlusLogo">
    <div class="Title" id="p-title">
      <div class="imgcontan">
        <div class="circle"></div>
        <div class="circlehide"></div>

        <img src="Images & Icons/Sprint+ logo blank.png" id="logo">
      </div>
      <a id="p-p-title"></a>
      <div class="Logs">
        <a href="logs.html" target="_blank">
          <span class="material-symbols-outlined">
            help
          </span>
          Infos
        </a>
      </div>
      <div class="Support">
        <a href="https://discord.com/invite/72tACSk8Jd" target="_blank">
          <span class="material-symbols-outlined">
            supervisor_account
          </span>
          Support
        </a>
      </div>
    </div>
    <div class="all-contain" id="all-contain">
      <div class="all-c-p"  onclick="Menu()">
        <span class="material-symbols-outlined">
          home
        </span>
        <div class="all-c-p-d">
          Home
        </div>
      </div>
      <div class="all-c-p"  onclick="GoalsShowUp()">
        <span class="material-symbols-outlined">
          monitoring
        </span>
        <div class="all-c-p-d">
          Progress
        </div>
      </div>
      <div class="all-c-p" onclick="ProjectShowUp()">
        <span class="material-symbols-outlined">
          folder
          </span>
        <div class="all-c-p-d">
          Projects
        </div>
      </div>
      <div class="all-c-p"onclick="ShowUpToDo()">
        <span class="material-symbols-outlined">
          pending_actions
          </span>
        <div class="all-c-p-d">
          To-Do
        </div>
      </div>
      <div class="all-c-p" onclick="OpenInspiration()">
        <span class="material-symbols-outlined">
          tips_and_updates
          </span>
        <div class="all-c-p-d">
          Inspiration
        </div>
      </div>
      <div class="all-c-p">
        <span class="material-symbols-outlined">
          edit_note
          </span>
        <div class="all-c-p-d">
          Writing
        </div>
      </div>
      <div class="all-c-p" onclick="OpenInfos()">
        <span class="material-symbols-outlined">
          manage_accounts
          </span>
          <div class="all-c-p-d">
            Account
          </div>
      </div>
      <div class="all-c-p" onclick="Download()">
        <span class="material-symbols-outlined">
          download
          </span>
        <div class="all-c-p-d" >
          Download
        </div>
      </div>
      <div class="all-c-p" onclick="Merge()">
        <span class="material-symbols-outlined">
          upload
          </span>
        <div class="all-c-p-d" >
          Merge
        </div>
      </div>
    </div>
    <div class="Main" id="Main">

      <div class="img-content">
        <img src = "Images & Icons/Page d'accueil/Important informations.png" style="height:100%">
      </div>
      <div class="main-more-content">
        <div class="utilities">
          <div class="featuring">
            <div class="f-t">
              <span class="material-symbols-outlined">
                groups
                </span>
              Sprint+ is featuring...
            </div>
            <div class="f-f">
            
              <div class="f-more">
                <div class="f-m-d">
                  Looking for a feat?
                </div>
                <button id="contactteam" onclick="window.open('https://discord.gg/72tACSk8Jd',target='_blank')">
                  Contact our team
                </button>
              </div>
            </div>
            
          </div>
          <div class="m-m-i">
            <div class="f-t">
              <span class="material-symbols-outlined">
                notifications_active
                </span>
              What's going on?
            </div>
            <div class="m-m-td" id="m-m-td">
            </div>
          </div>
        </div>
        <div class="more">
          <div class="mor-t" title="Want your story to be there? Contact our team.">
            <span class="material-symbols-outlined">
              auto_awesome
              </span>
            Our favorite stories
          </div>
          <div class="mor-st">
            <div class="st" >
              <div class="st-l">
                FR
              </div>
              <div class="st-t">
                Nous, et le monde
              </div>
              <div class="st-o">
                <span class="material-symbols-outlined"onclick="window.open('https://www.wattpad.com/1320458753-nous-et-le-monde-chapitre-1')">
                  open_in_new
                  </span>
                  <span class="material-symbols-outlined" onclick="window.open('https://www.wattpad.com/user/NafAuteur')">
                    face
                    </span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      let itemToHelp;


      if (!localStorage.getItem('user')) {
        document.getElementById('all-contain').style.visibility="hidden";
        document.getElementById('p-p-title').innerHTML = "Welcome to Sprint+!"
        document.getElementById('Main').innerHTML = `
          <div class="welcome-f">
            <div class="w-t">
            Welcome, dear writer!
            </div>
            <div class="w-info">
              You are about to register yourself into Sprint+.<br><br>
              First, you must know that this website is a project made
              by a private person.<br>
              None of your datas are used by us or any other person.
              All your datas are stored in your browser, and are 
              known only by you and your browser.<br><br>We do not sell,
              use, lookup, save, or see any of your datas.<br<br>In
              this way, all the passwords you will set will have a 
              minimal amount of security: anyone with a bit of coding 
              experience will be able to find your passwords. However,
              keep in mind that this doesn't change anything to the point
              of the website, and will not affect in any way your use of 
              Sprint+, because no one would steal your progress.
              <br><br>
              Sprint+ and our team are not responsible of any corruption
              due to a tricky modification of your datas on your side. 
              You are responsible of the way you modify your datas.
              <br><br>
              For more informations, click on the button at the right (top) of the main menu page.
              <br><br>
              Now, please, complete some informations about you, so we 
              can setup your whole session.<br><br><br>
              <div class="q">
              <div class="q-q">
                <div class="q-t">
                  What is your name?
                </div>
                <input autocomplete="off" type="text" id="name" style="background-color:rgba(31, 48, 92, 0.7)">
              </div>
              <div class="q-q">
                <div class="q-t" >
                  Enter a secure password (6 characters min.)
                </div>
                <input autocomplete="off" type="text"id="password" style="background-color:rgba(31, 48, 92, 0.7)">
              </div>
              </div>
            </div>
            <button id="go" onclick="GoFor()">
              Create a session
              <span class="material-symbols-outlined">
              login
              </span>
            </button>
          </div>
        `;
      } else {
        mainMenuShowUp()
      }
      function GoFor() {
        let user = {};
        let password = document.getElementById('password');
        let name = document.getElementById('name');
        if (password.value.length <=5 || password.value.includes('"') || password.value.includes("'") ) {
          password.style.border = "2px solid red";
        } else {
          user["password"]=password.value;
        }
        if (!name.value.length) {
          name.style.border = "2px solid red";
        } else {
          user["name"]=name.value;
        }
        if (user['name'] && user['password']) {
          user['checkup'] = true;
          localStorage.setItem('user',JSON.stringify(user));
          mainMenuShowUp();
        }
      }
      function mainMenuShowUp() {
        let NotifNB = 0;
        let goaled = false;
        document.getElementById('Main').innerHTML=Main;
        document.getElementById('all-contain').innerHTML=all_contain;
        document.getElementById('all-contain').style.visibility="visible";
        let sentences = [
          `Welcome back ${JSON.parse(localStorage.getItem('user')).name}. We were waiting for you!`,
          `Nice to see you again ${JSON.parse(localStorage.getItem('user')).name}!`,
          `We missed you, ${JSON.parse(localStorage.getItem('user')).name}. So cool for you to be there!`,
          `Be confident, ${JSON.parse(localStorage.getItem('user')).name}!`,
          `More people than what you think loves you, ${JSON.parse(localStorage.getItem('user')).name}!`,
          `Create great things, ${JSON.parse(localStorage.getItem('user')).name}!`,
          `${JSON.parse(localStorage.getItem('user')).name}, you're a creator of worlds!`,
          `It is time for you to make people dream big, ${JSON.parse(localStorage.getItem('user')).name}!`,
          `You're the reason why people like to read, ${JSON.parse(localStorage.getItem('user')).name}!`,
          `Be proud of you, because you deserve it, ${JSON.parse(localStorage.getItem('user')).name}!`,

        ]
        document.getElementById('p-p-title').innerHTML = sentences[Math.floor(Math.random()*sentences.length)];
        let items = {...localStorage};
        let today = new Date(); 
        let cm = [
              "What's that?",
              "Oh no!",
              "Hurry!",
              "What am I seeing?!",
              "That ain't true!",
              "What?!"
            ]
        for (let [k,v] of Object.entries(items)) {
          if (k.includes('goal')) {
            let g = JSON.parse(v);
            let Start = new Date(g.started_on);  
            let Time = parseInt(g.duration)
            let Today = new Date();
            Today.setHours(0,0,0,0)
            let TD = 0;
            let ClockSet = false;
            console.log('TIME IS ' + Time)
            for (let i = 1; i < Time+1; i++) {
              let d =Start.getTime() + 86400000*i;
              d = new Date(d);
              console.log(`${d.getDate()}/${d.getMonth()+1}`)
              d.setHours(0,0,0,0)
              if (
                ClockSet != true && d.getDate() === Today.getDate() && 
                d.getMonth() === Today.getMonth() && 
                d.getFullYear() === Today.getFullYear() 
                )  {

                  TD = i;
                  ClockSet = true;
                }
            }
            console.log('TODAY IS ' + Today)
            console.log('Time is ' + Time + " and today is" + g.words)

            if (((!g.updates[TD]) || g.words < g.updates[TD]) && g.started === true ) {
              NotifNB++;
              document.getElementById('m-m-td').innerHTML+=`
                <div class="alert">
                  <div class="c-m">
                    <span class="material-symbols-outlined">
                  ssid_chart
                  </span>
                      ${cm[Math.floor((Math.random() * cm.length))]}
                  </div>
                  <div class="c-d-c" onclick="GoalsShowUp()">
                    You didn't work on ${g.name} today
                  </div>
                </div>
              `;
              goaled=true;
              console.log("GOALED IS "+ goaled);
            }
          } else if (k.includes("Project")) {
            let pj = JSON.parse(v);
            if (pj.tasks) {
              for (let i = 0; i < pj.tasks.length; i++ ) {
                let task = pj.tasks[i];
                if (task.validated != true) {
                  let date = new Date(task.for);
                  date = date.setHours(0,0,0,0);
                  if (today === date) {
                    NotifNB++;
                    document.getElementById('m-m-td').innerHTML+=`
                      <div class="alert">
                        <div class="c-m">
                          <span class="material-symbols-outlined">
                        task
                        </span>
                            ${cm[Math.floor((Math.random() * cm.length))]}
                        </div>
                        <div class="c-d-c" onclick="ShowUpToDo()">
                          You didn't finish your « ${task.name} » task!
                        </div>
                      </div>
                    `;
                  }
                }
              }
            }
          }
          if (NotifNB>0) {
            document.getElementById('notifnb').style.visibility = "visible";
            document.getElementById('notifnb').innerHTML = `
              ${NotifNB<=9 ? NotifNB : "9+"} 
            `;

          }
        }
        checkIfGoals(goaled);
        console.log(NotifNB + " is amount of notifs")
      }
      function checkIfGoals(g) {
        console.log(g)

        if (!g) {

          document.getElementById('m-m-td').innerHTML+=`
            <div class="nothing-to-see-here">
              Nothing to work on for today.<br>
              You made it, <br>
              you deserve a reward.<br>
              Take care of yourself, please.<br>
              <br>
              Love,<br>
              Sprint+ team.
            </div>
          `;
        }
      }
    </script> 
  </body>

</html>